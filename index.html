<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Uno Simplified - Nunox</title>
<style>
  body { font-family: Arial; background: #2d2d2d; color: #fff; display: flex; flex-direction: column; align-items: center; padding: 20px; }
  #board { display: flex; flex-direction: column; align-items: center; margin-top: 20px; }
  .hand { display: flex; gap: 10px; margin: 10px; }
  .card { width: 60px; height: 90px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 20px; cursor: pointer; transition: transform 0.3s; }
  .card:hover { transform: scale(1.2); }
  #pile { width: 60px; height: 90px; border-radius: 8px; background: #444; display: flex; align-items: center; justify-content: center; margin: 10px; font-weight: bold; font-size: 20px; }
  #messages { margin-top: 10px; min-height: 20px; }
</style>
</head>
<body>

<h1>UNO Simplified - Nunox</h1>

<audio id="bgm" src="bgm.mp3" autoplay loop></audio>

<div id="board">
  <div>Computer's Hand: <span id="compCount"></span> cards</div>
  <div id="pile">♠️</div>
  <div class="hand" id="playerHand"></div>
</div>
<div id="messages"></div>

<script>
  const colors = ['red','green','blue','yellow'];
  const values = ['0','1','2','3','4','5','6','7','8','9'];

  let deck = [];
  for(let c of colors){
    for(let v of values){ deck.push({color:c,value:v}); }
  }
  deck = shuffle(deck);

  function shuffle(array){
    for(let i=array.length-1;i>0;i--){
      const j=Math.floor(Math.random()*(i+1));
      [array[i],array[j]]=[array[j],array[i]];
    }
    return array;
  }

  let playerHand=[], compHand=[];
  for(let i=0;i<5;i++){
    playerHand.push(deck.pop());
    compHand.push(deck.pop());
  }

  let pile = deck.pop();
  updateBoard();

  function renderHand(){
    const handDiv=document.getElementById('playerHand');
    handDiv.innerHTML='';
    playerHand.forEach((card,index)=>{
      const cDiv=document.createElement('div');
      cDiv.className='card';
      cDiv.style.background=card.color;
      cDiv.textContent=card.value;
      cDiv.onclick=()=> playerPlay(index);
      handDiv.appendChild(cDiv);
    });
  }

  function updateBoard(msg=''){
    document.getElementById('pile').textContent=pile.value;
    document.getElementById('pile').style.background=pile.color;
    document.getElementById('compCount').textContent=compHand.length;
    renderHand();
    document.getElementById('messages').textContent=msg;
  }

  function playerPlay(idx){
    const card = playerHand[idx];
    if(card.color === pile.color || card.value === pile.value){
      pile = playerHand.splice(idx,1)[0];
      updateBoard("You played a card!");
      if(playerHand.length===0){ updateBoard("You won!"); return; }
      setTimeout(compTurn, 1000);
    } else {
      updateBoard("Card doesn't match pile!");
    }
  }

  function compTurn(){
    let played=false;
    for(let i=0;i<compHand.length;i++){
      const card=compHand[i];
      if(card.color===pile.color || card.value===pile.value){
        pile=compHand.splice(i,1)[0];
        updateBoard("Computer played a card!");
        played=true;
        break;
      }
    }
    if(!played){
      while(deck.length){
        const draw=deck.pop();
        compHand.push(draw);
        if(draw.color===pile.color || draw.value===pile.value){
          pile=compHand.pop();
          updateBoard("Computer drew and played a card!");
          played=true;
          break;
        }
      }
    }
    if(compHand.length===0){ updateBoard("Computer won!"); return; }
  }
</script>

</body>
</html>
